(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-release-release"],{"4de4":function(e,t,i){"use strict";i.r(t);var a=i("607a"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);t["default"]=n.a},"607a":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(i("a34a"));function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,i,a,n,o,s){try{var r=e[o](s),c=r.value}catch(l){return void i(l)}r.done?t(c):Promise.resolve(c).then(a,n)}function s(e){return function(){var t=this,i=arguments;return new Promise(function(a,n){var s=e.apply(t,i);function r(e){o(s,a,n,r,c,"next",e)}function c(e){o(s,a,n,r,c,"throw",e)}r(void 0)})}}var r={data:function(){return{title:"",content:"",isRelease:!1,imageList:[],saveImages:[]}},methods:{inspectRelease:function(){this.title<=0||this.content<=0?this.isRelease=!1:this.isRelease=!0},title_Input:function(e){this.title=e.target.value,this.inspectRelease()},content_Input:function(e){this.content=e.target.value,this.inspectRelease()},release:function(){var e=this;if(this.inspectRelease(),this.isRelease){if(0==this.imageList.length)return void this.$tool.showToast("至少上传一个美图");this.$tool.loading("处理中"),this.$http.post("user/pub_post",{title:this.title,content:this.content,content_image:this.saveImages}).then(function(t){e.$tool.loading("hide"),0==t.code&&(e.title="",e.content="",e.imageList=[],e.saveImages=[],e.$tool.showToast("发表成功"),uni.switchTab({url:"../community/community?refresh=1",animationDuration:400})),e.$tool.showToast(t.message),console.log(t)}).catch(function(t){e.$tool.loading("hide"),console.log("pub_err")})}},goBack:function(){uni.navigateBack({delta:1,animationType:"pop-out",animationDuration:200})},close:function(e){this.imageList.splice(e,1),this.saveImages.splice(e,1)},chooseImage:function(){var e=s(a.default.mark(function e(){var t,i=this;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(9!==this.imageList.length){e.next=7;break}return e.next=3,this.isFullImg();case 3:if(t=e.sent,console.log("是否继续?",t),t){e.next=7;break}return e.abrupt("return");case 7:uni.chooseImage({sourceType:["camera","album"],sizeType:["compressed","original"],count:1,success:function(e){i.$http.upload("user/upload_forum_image",{},{filePath:e.tempFilePaths[0],name:"file"}).then(function(e){if(e=JSON.parse(e),console.log(e),0==e.code){var t=e.data;return i.imageList.push(t.domain+t.image_url),i.saveImages.push(t.image_url),!1}i.$tool.showToast(e.message)}).catch(function(e){console.log("upload_err")})}});case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),isFullImg:function(){var e=this;return new Promise(function(t){uni.showModal({content:"已经有9张图片了,是否清空现有图片？",success:function(i){i.confirm?(e.imageList=[],e.saveImages=[],t(!0)):t(!1)},fail:function(){t(!1)}})})},previewImage:function(e){var t=e.target.dataset.src;console.log(this.imageList),uni.previewImage({current:t,urls:this.imageList})}}};t.default=r},"7a73":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"index"},[i("v-uni-view",{staticClass:"wrap"},[i("v-uni-view",{staticClass:"top uni-flex"},[i("v-uni-view",{staticClass:"cancel",on:{click:function(t){t=e.$handleEvent(t),e.goBack(t)}}},[i("v-uni-text",[e._v("取消")])],1),i("v-uni-view",{staticClass:"title"},[i("v-uni-text",[e._v("我要晒")])],1),i("v-uni-view",{staticClass:"release",class:1==e.isRelease?"active":"",on:{click:function(t){t=e.$handleEvent(t),e.release(t)}}},[i("v-uni-text",[e._v("发表")])],1)],1),i("v-uni-view",{staticClass:"middle"},[i("v-uni-view",{staticClass:"title"},[i("v-uni-input",{attrs:{type:"text",placeholder:"标题(最多可输入50个字)","placeholder-style":"color:#acaaaa"},on:{input:function(t){t=e.$handleEvent(t),e.title_Input(t)}}})],1),i("v-uni-view",{staticClass:"content"},[i("v-uni-textarea",{attrs:{placeholder:"来都来了不吐槽什么吗？","placeholder-style":"color:#acaaaa"},on:{input:function(t){t=e.$handleEvent(t),e.content_Input(t)}}})],1)],1),i("v-uni-view",{staticClass:"upLoader"},[i("v-uni-view",{staticClass:"upLoader_files"},[e._l(e.imageList,function(t,a){return[i("v-uni-view",{key:a+"_0",staticClass:"uni-uploader__file"},[i("v-uni-image",{staticClass:"uni-uploader__img",attrs:{src:t,"data-src":t},on:{click:function(t){t=e.$handleEvent(t),e.previewImage(t)}}}),i("v-uni-view",{staticClass:"close-view",on:{click:function(t){t=e.$handleEvent(t),e.close(a)}}},[e._v("x")])],1)]}),i("v-uni-view",{staticClass:"camera uni-center"},[i("v-uni-image",{attrs:{src:"../../static/images/camera.png"},on:{click:function(t){t=e.$handleEvent(t),e.chooseImage(t)}}})],1)],2)],1)],1)],1)},n=[];i.d(t,"a",function(){return a}),i.d(t,"b",function(){return n})},8418:function(e,t,i){"use strict";var a=i("ef2f"),n=i.n(a);n.a},"99e5":function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,".wrap[data-v-5688a9f6]{width:%?750?%}.top[data-v-5688a9f6]{width:%?660?%;height:%?140?%;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:%?0?% %?40?%}.top uni-view[data-v-5688a9f6]{font-size:%?32?%;color:#898989}.top .cancel[data-v-5688a9f6]{position:relative;width:%?100?%}.top .title[data-v-5688a9f6]{color:#171717}.top .release[data-v-5688a9f6]{position:relative;width:%?100?%;text-align:right}.top .active[data-v-5688a9f6]{color:#f4cc7e}.middle[data-v-5688a9f6]{width:%?750?%;border-bottom:%?1?% solid #f5f5f5}.middle .title[data-v-5688a9f6]{height:%?80?%;margin:%?0?% %?40?%;border-bottom:%?2?% solid #e9e9e9}.middle .title uni-input[data-v-5688a9f6]{height:%?80?%}.middle .content[data-v-5688a9f6]{height:%?520?%;margin:%?20?% %?40?%}\r\n/* 上传图片 */.upLoader[data-v-5688a9f6]{margin:%?20?% %?30?%}.uni-uploader__file[data-v-5688a9f6]{margin:%?10?%;width:%?210?%;height:%?210?%;position:relative}.upLoader .upLoader_files[data-v-5688a9f6]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.uni-uploader__img[data-v-5688a9f6]{display:block;width:%?210?%;height:%?210?%}.upLoader .camera[data-v-5688a9f6]{width:%?210?%;height:%?210?%}.upLoader .camera uni-image[data-v-5688a9f6]{width:%?109?%;height:%?84?%}.close-view[data-v-5688a9f6]{text-align:center;line-height:%?22?%;height:%?24?%;width:%?24?%;border-radius:50%;background:#ef5350;color:#fff;position:absolute;top:%?6?%;right:%?8?%;font-size:%?24?%}",""])},a34a:function(e,t,i){e.exports=i("bbdd")},bbdd:function(e,t,i){var a=function(){return this||"object"===typeof self&&self}()||Function("return this")(),n=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,o=n&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=i("96cf"),n)a.regeneratorRuntime=o;else try{delete a.regeneratorRuntime}catch(s){a.regeneratorRuntime=void 0}},ef2f:function(e,t,i){var a=i("99e5");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("d01b8ee2",a,!0,{sourceMap:!1,shadowMode:!1})},f66c:function(e,t,i){"use strict";i.r(t);var a=i("7a73"),n=i("4de4");for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);i("8418");var s=i("2877"),r=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"5688a9f6",null);t["default"]=r.exports}}]);